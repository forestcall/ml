---
import PageLayout from "@layouts/PageLayout.astro";
import Gallery from "@components/Gallery.astro";

interface Image {
  imgUrl: string;
  alt: string;
}

const imageFiles: string[] = [
  "_K9V6781_.jpg",
  "adidas_man_green_ip_2_.jpg",
  "AdidasWoman__3.jpg",
  "Andrew_A__3.jpg",
  "Angel_Blanco_Jr_SKY_ip6_.jpg",
  "archive_ad_1_revised_.jpg",
  "archive_ad_2_revised_.jpg",
  "archive_ad_3_revised_.jpg",
  "archive_ad_4_revised_.jpg",
  "B&O_Claudine_.jpg",
  "bertoia_chair_.jpg",
  "BiancaSilva_1_.jpg",
  "BiancaSilva_3_.jpg",
  "Blue_Demon_Jr_SKY_.jpg",
  "bullfighter_bullrider_.jpg",
  "callalily_Jamie__3.jpg",
  "Celestine_w_hat_&_scarf_.jpg",
  "Claudine_4_.jpg",
  "Claudine_B&O_2_.jpg",
  "Deleon_test_B_(wo_bottle)_.JPG",
  "dying_flower__4.jpg",
  "Epson_Painted_Lady_.jpg",
  "eye-butterfly_print_.jpg",
  "Feather_Katie_.jpg",
  "Franziska_hair_.jpg",
  "gigli_wind_.jpg",
  "Giglianne_.jpg",
  "HydrapakBiker__3.jpg",
  "HydrapakSkier__3.jpg",
  "HydrapakTravis__3.jpg",
  "Italian_Girl_ip5_.jpg",
  "J_in_car_montage_B_print_.jpg",
  "Jacki_in_pool_1_.jpg",
  "Jacki_w_palm_.jpg",
  "Jacki_w_tree_fern_.jpg",
  "Jade_Sitting_ip_10_.jpg",
  "jaja_kick_2_.jpg",
  "Jamie_in_pool_1_ip5_.jpg",
  "Jess_walking_on_path_print_.jpg",
  "Jill_1_ip7_.jpg",
  "Julia_ip_5_.jpg",
  "Katie_Laughing_.jpg",
  "Ken_Watanabe__3.jpg",
  "L_&_B_on_chaise_.jpg",
  "leaf_Jamie_.jpg",
  "Mareeya_8_gray_ip22_.jpg",
  "Melody_blue_.jpg",
  "Mistico_ip3_.jpg",
  "Monje_Maldito_SKY_.jpg",
  "Nick__3.jpg",
  "Nike_test_blue-green-yellow_.jpg",
  "Nike_test-Morgan_ip2_.jpg",
  "Nike_white_ip11_DD_.jpg",
  "Nina_b&w__3.jpg",
  "Occo_daylight_.jpg",
  "Occo_daylight_color_.jpg",
  "Olivier_A_.jpg",
  "Olivier_dark_.jpg",
  "olivier_w_cig_.jpg",
  "Russian_Girl_Dream_ip2_.jpg",
  "Sara_w_dog_.jpg",
  "Soccer_test_chest_.jpg",
  "soccer_test_goalie_.jpg",
  "Soccer_test_kick_2_.jpg",
  "Super_Porky_ip5_.jpg",
  "The_Knick_1_.jpg",
  "The_Knick_3a_.jpg",
  "The_Knick_6a_.jpg",
  "The_Knick_7_.jpg",
  "The_Knick_11a_.jpg",
  "The_Knick_Print_.jpg",
  "Tony_Shahloub_polaroid_.jpg",
  "Tony_Shalhoub_portrait_B&W_.jpg",
  "Tova_black_sand_1_.jpg",
  "Tova_hat_8x10_.jpg",
  "Tova_hood_1_.jpg",
  "Ty_w_hat_.jpg",
  "Veronica_6_.jpg",
  "Vicki_w_monstera_leaf_ip2_.jpg",
  "Victoria_ip6_.jpg"
];

const images: Image[] = imageFiles.map(file => ({
  imgUrl: `/images/photos/people/${file}`,
  alt: file.replace(/\.(jpg|jpeg|png|gif)$/i, '')
           .replace(/[_-]/g, ' ')
           .replace(/\s+/g, ' ')
           .trim()
}));
---

<PageLayout title="People" description="A gallery of people photographs">
  <div class="w-full max-w-screen-xl mx-auto px-4 mt-[60px]">
    <Gallery images={images} />
  </div>
</PageLayout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const images = document.querySelectorAll('.gallery-image');
    images.forEach((img, index) => {
      if (img instanceof HTMLImageElement) {
        img.addEventListener('error', function() {
          console.error(`Failed to load image ${index + 1}: ${this.src}`);
          // Instead of hiding the image, let's show an error placeholder
          this.src = 'data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22100%22%20height%3D%22100%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Crect%20width%3D%22100%22%20height%3D%22100%22%20fill%3D%22%23eee%22%2F%3E%3Ctext%20x%3D%2250%25%22%20y%3D%2250%25%22%20dominant-baseline%3D%22middle%22%20text-anchor%3D%22middle%22%20font-size%3D%2214%22%20fill%3D%22%23aaa%22%3EError%3C%2Ftext%3E%3C%2Fsvg%3E';
          this.alt = 'Error loading image';
        });
        img.addEventListener('load', function() {
          console.log(`Successfully loaded image ${index + 1}: ${this.src}`);
        });
      }
    });
  });

  // Function to check if images are loading correctly
  function checkImages() {
    const images = document.querySelectorAll('.gallery-image');
    images.forEach((img, index) => {
      if (img instanceof HTMLImageElement) {
        fetch(img.src)
          .then(response => {
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.blob();
          })
          .then(() => console.log(`Image ${index + 1} is accessible`))
          .catch(e => console.error(`Error with image ${index + 1}: ${e.message}`));
      }
    });
  }

  // Run the check after a short delay to ensure all images have been processed
  setTimeout(checkImages, 2000);
</script>
